<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Google ë¡œê·¸ì¸ | TexTune</title>
    <style>
      :root{
        --bg:#0f1222; --panel:#191c33; --panel2:#14172a; --stroke:#2a2f55; --text:#e8e8f0; --muted:#aab; --brand:#8ad;
        --grad1:#a65cff; --grad2:#4b63ff; --google:#fff;
      }
      *{box-sizing:border-box}
      body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;margin:0;background:var(--bg);color:var(--text)}
      header{position:sticky;top:0;background:#0f1222ee;backdrop-filter:saturate(150%) blur(4px);border-bottom:1px solid var(--stroke)}
      .wrap{max-width:980px;margin:0 auto;padding:16px}
      .row{display:flex;align-items:center;justify-content:space-between;gap:12px}
      .brand{display:flex;align-items:center;gap:10px;font-weight:700}
      .badge{width:28px;height:28px;border-radius:8px;background:linear-gradient(135deg,var(--grad1),var(--grad2));display:grid;place-items:center}
      .badge span{font-size:16px}
      nav a{color:var(--brand);margin-left:14px;text-decoration:none}
      nav .muted{opacity:.8;font-size:12px;margin-left:6px}
      .panel{background:var(--panel);border:1px solid var(--stroke);border-radius:14px;padding:20px;margin-top:24px}
      h1{margin:0 0 12px;font-size:28px}
      p{margin:0 0 12px;color:var(--muted)}
      .google-btn{display:flex;align-items:center;gap:10px;padding:14px 16px;border-radius:12px;border:1px solid #dadce0;background:var(--google);color:#202124;font-weight:700;text-decoration:none;justify-content:center}
      .google-btn:hover{box-shadow:0 10px 24px rgba(0,0,0,.18)}
      .error{color:#ff9c9f;margin-top:8px;font-size:14px}
      .hint{font-size:13px;color:var(--muted)}
      .user-tag{font-size:12px;color:var(--muted)}
    </style>
  </head>
  <body>
    <header>
      <div class="wrap row">
        <a class="brand" href="/">
          <div class="badge"><span>ğŸµ</span></div>
          <div>TexTune</div>
        </a>
        <nav>
          <a href="library.html">ë³´ê´€í•¨</a>
          <a id="authAction" class="nav-btn" href="login.html">ë¡œê·¸ì¸</a>
          <span id="authUser" class="user-tag"></span>
        </nav>
      </div>
    </header>

    <main class="wrap">
      <section class="panel">
        <h1>Googleë¡œ ë¡œê·¸ì¸</h1>
        <p>êµ¬ê¸€ ê³„ì • í•œ ë²ˆìœ¼ë¡œ TexTuneì„ ë°”ë¡œ ì´ìš©í•˜ì„¸ìš”.</p>
        <a class="google-btn" id="googleBtn" href="/v1/auth/google/start">
          <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="" width="18" height="18" />
          <span>Googleë¡œ ê³„ì†í•˜ê¸°</span>
        </a>
        <p class="hint">ë¡œê·¸ì¸ í›„ ì´ì „ í˜ì´ì§€ë¡œ ìë™ ì´ë™í•©ë‹ˆë‹¤.</p>
        <div id="error" class="error"></div>
      </section>
    </main>

    <script src="js/app.js"></script>
    <script>
      (async () => {
        await hydrateAuthControls();
        const params = new URLSearchParams(location.search);
        const next = params.get('next') || '/generate.html';
        const btn = document.getElementById('googleBtn');
        if (btn) btn.href = `/v1/auth/google/start?next=${encodeURIComponent(next)}`;

        try {
          const me = await getMe();
          if (me) window.location.href = next;
        } catch {}
      })();
    </script>
  </body>
</html>
